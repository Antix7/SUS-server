<!DOCTYPE html>
<html lang="pl-PL">
<head>
  <meta charset="UTF-8">
  <title>Generator kluczy</title>
</head>
<body>
  <form id="key_form">

    <input type="checkbox" id="czy_admin" name="czy_admin">
    <label for="czy_admin"> Uprawnienia administratora </label> <br>

    <label for="data"> Data wygaśnięcia &nbsp; </label>
    <input type="date" id="data" name="data"><br>
    <label for="data"> Zostaw ustawione na dd/mm/yyyy aby konto nie wygasło </label>

    <br><br>
    <input type="submit" id="submit_btn" value="Generuj klucz">

  </form>

  <p id="key"></p>

  <form action="/panel" method="get">
    <input type="submit" value="Wróć">
  </form>

  <script>

    // dzieki chatgpt
    const key_form = document.getElementById("key_form");
    const key_paragraph = document.getElementById("key");

    key_form.addEventListener("submit", (e) => {
      e.preventDefault();

      fetch("/panel/generuj_klucz/auth", {
        method: "POST",
        body: new FormData(key_form)
      })
              .then(response => response.json())
              .then(data => {
                key_paragraph.innerText = data.message;
              })
              .catch(error => {
                key_paragraph.innerText = "Nastąpił błąd, spróbuj ponownie później.";
              })
    });

  </script>
</body>
</html>