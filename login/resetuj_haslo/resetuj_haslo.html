<!DOCTYPE html>
<html lang="pl-PL">
<head>
    <meta charset="UTF-8">
    <title>Kod do resetu hasła</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>

    <script>
        $(document).ready(function(){

            $("#get_code_submit_btn").click(function() {
                $.post(
                    "/resetuj_haslo/get_code",
                    $("#get_code_form").serializeArray(),
                    function(data, status) {
                        $("#get_code_status").text(data);
                    });
            });

            $("#enter_code_submit_btn").click(function() {
                $.post(
                    "/resetuj_haslo/submit_code",
                    $.merge($("#get_code_form").serializeArray(), $("#enter_code_form").serializeArray()),
                    function(data, status) {
                        if(data.text) {
                            $("#enter_code_status").text(data.text);
                        }
                        if(data.redirect) {
                            window.location.href = data.redirect;
                        }
                    });
            });

        });
    </script>

</head>
<body>
<form id="get_code_form">
    <input required type="text" name="username" id="username" placeholder="Nazwa użytkownika"><br>
    <input type="button" id="get_code_submit_btn" value="Wyślij kod"><br>
</form>

<p id="get_code_status"></p>

<form id="enter_code_form">
    <input required type="text" name="code" id="code" placeholder="Kod otrzymany mailem"><br>
    <input type="button" id="enter_code_submit_btn" value="Resetuj hasło"><br>
</form>

<p id="enter_code_status"></p>

<form action="/wyloguj" method="get">
    <input type="submit" value="Wróć">
</form>

</body>
</html>